<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Books Catalog</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 40px; line-height: 1.6; }
        header { border-bottom: 2px solid #333; margin-bottom: 20px; }
        
        /* Button Style */
        #get-books-btn { 
            background-color: #00567a; color: white; border: none; 
            padding: 10px 20px; cursor: pointer; font-size: 16px; margin-bottom: 20px;
        }

        /* List Area */
        #books-list-container { 
            background-color: #dcdcdc; padding: 15px; width: 350px; 
            min-height: 100px; margin-bottom: 30px; border: 1px solid #999;
        }
        .book-item { cursor: pointer; margin-bottom: 5px; }
        .book-item:hover { text-decoration: underline; color: #00567a; }

        /* Details Area */
        #details-container { 
            border: 1px solid #999; background-color: #f9f9f9; 
            padding: 20px; width: 450px; display: none; 
        }
        .detail-row { display: flex; margin-bottom: 5px; }
        .label { font-weight: bold; width: 120px; }
        .value { flex: 1; }
    </style>
</head>
<body>

    <header>
        <h1>Books Catalogue developed by s225500276</h1>
    </header>

    <button id="get-books-btn">Get all books</button>

    <div id="books-list-container">
        <div id="list-content">Click the button to load books.</div>
    </div>

    <div id="details-container">
        <div class="detail-row"><span class="label">Title:</span> <span id="det-title" class="value"></span></div>
        <div class="detail-row"><span class="label">Author:</span> <span id="det-author" class="value"></span></div>
        <div class="detail-row"><span class="label">Year:</span> <span id="det-year" class="value"></span></div>
        <div class="detail-row"><span class="label">Genre:</span> <span id="det-genre" class="value"></span></div>
        <div class="detail-row"><span class="label">Summary:</span> <span id="det-summary" class="value"></span></div>
        <div class="detail-row"><span class="label">Price (AUD):</span> <span id="det-price" class="value"></span></div>
    </div>

    <script>
        const btn = document.getElementById('get-books-btn');
        const listContent = document.getElementById('list-content');
        const detailsContainer = document.getElementById('details-container');

        // 1. Fetch all books
        btn.addEventListener('click', () => {
            fetch('/api/books')
                .then(res => res.json())
                .then(books => {
                    listContent.innerHTML = ''; // Clear message
                    books.forEach(book => {
                        const div = document.createElement('div');
                        div.className = 'book-item';
                        // Matches the format: Title Price AUD
                        div.textContent = `${book.title} ${book.price} AUD`;
                        
                        // 2. Click event for details
                        div.onclick = () => fetchBookDetails(book.id);
                        listContent.appendChild(div);
                    });
                })
                .catch(err => console.error("Error loading books:", err));
        });

        // 3. Fetch single book by ID
        function fetchBookDetails(bookId) {
            fetch(`/api/books/${bookId}`)
                .then(res => res.json())
                .then(book => {
                    document.getElementById('det-title').textContent = book.title;
                    document.getElementById('det-author').textContent = book.author;
                    document.getElementById('det-year').textContent = book.year;
                    document.getElementById('det-genre').textContent = book.genre;
                    document.getElementById('det-summary').textContent = book.summary;
                    document.getElementById('det-price').textContent = book.price;
                    
                    detailsContainer.style.display = 'block';
                })
                .catch(err => console.error("Error loading details:", err));
        }
    </script>
</body>
</html>
